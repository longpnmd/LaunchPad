http:
  routers:
    # Define a connection between requests and services
    dashboard:
      rule: (Host(`traefik.{{ env "BASE_DOMAIN" }}`) && (PathPrefix(`/api`) || PathPrefix(`/dashboard`)))
      service: api@internal
      middlewares:
        - basic-auth
      tls:
        certResolver: myresolver
    strapi:
      rule: Host(`beta-admin.{{ env "BASE_DOMAIN" }}`)
      service: strapi@docker
      middlewares:
        - rate-limit
      tls:
        certResolver: myresolver
    nextjs:
      rule: Host(`beta.{{ env "BASE_DOMAIN" }}`)
      service: nextjs@docker
      middlewares:
        - rate-limit
      tls:
        certResolver: myresolver
    n8n:
      rule: Host(`n8n-beta.{{ env "BASE_DOMAIN" }}`)
      service: n8n@docker
      middlewares:
        - rate-limit
      tls:
        certResolver: myresolver
    portainer:
      rule: Host(`portainer-beta.{{ env "BASE_DOMAIN" }}`)
      service: portainer@docker
      middlewares:
        - rate-limit
      tls:
        certResolver: myresolver
  middlewares:
    basic-auth:
      basicAuth:
        usersFile: "/config/.htpasswd"
        realm: "Traefik 2 Basic Auth"
    rate-limit:
      rateLimit:
        average: 100
        burst: 50
    https-redirectscheme:
      redirectScheme:
        scheme: https
        permanent: true
    compress:
      compress: {}